{% macro source_selector(shortname, fullname, counts, sources_searched, query, sub_source) -%}
    <li>
        <div class="source">
            <div class="source_header">
                <span class="source_icon {{shortname}}_icon">&nbsp;</span>
                    <a href="/search?query={{query}}&source={{shortname}}">
                        {% if shortname in sources_searched and sources_searched|length == 1 %}
                            <strong>{{fullname}}</strong>
                        {% else %}
                            {{fullname}}
                        {% endif %}
                    </a>
                </span>
                <span class="source_count {{"nonzero" if counts['source'][shortname] > 0}}">({{counts['source'][shortname]}})</span>
            </div>
            <div class="subsource_list">
                {% if shortname == 'github' %}
                    {% for repo, count in counts['repo']|dictsort(true) %}
                        <div class="subsource">
                            <a href="/search?query={{query}}&source=github&repo={{repo}}" class="subsource_name">
                                {% if repo == sub_source %}
                                    <strong>{{repo}}</strong>
                                {% else %}
                                    {{repo}}
                                {% endif %}
                            </a>
                            <span class="subsource_count">({{count}})</span>
                        </div>
                    {% endfor %}
                {% endif %}
                {% if shortname == 'jira' %}
                    {% for project, count in counts['project']|dictsort(true) %}
                        <div class="subsource">
                            <a href="/search?query={{query}}&source=jira&project={{project}}" class="subsource_name">
                                {% if project == sub_source %}
                                    <strong>{{project}}</strong>
                                {% else %}
                                    {{project}}
                                {% endif %}
                            </a>
                            <span class="subsource_count">({{count}})</span>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </label>
    </li>
{% endmacro %}
