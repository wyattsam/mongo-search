{% macro source_selector(shortname, fullname, counts, source, query, sub_source) -%}
    <li>
        <div class="source">
            <div class="source_header">
                <span class="source_icon {{shortname}}_icon">&nbsp;</span>
                    <a href="/search?query={{query}}&source={{shortname}}">
                        {% if shortname == source %}
                            <strong>{{fullname}}</strong>
                        {% else %}
                            {{fullname}}
                        {% endif %}
                    </a>
                </span>
                <span class="source_count {{"nonzero" if counts['source'][shortname] > 0}}">({{counts['source'][shortname]}})</span>
            </div>
            <div class="subsource_list">
                {% set ss = SUBSOURCES[shortname] %}
                {% if counts[ss['name']] %}
                    {% for sub, count in counts[ss['name']]|dictsort(true) %}
                        <div class="subsource{{ ' selected' if sub==sub_source  else ''}}" >
                            <a href="/search?query={{query}}&source={{shortname}}&{{ss['name']}}={{sub}}" class="subsource_name">
                                  {{sub}}
                            </a>
                            <span class="subsource_count">({{count}})</span>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </label>
    </li>
{% endmacro %}
